# Kong configuration file
# Database settings
database = postgres
pg_host = postgres
pg_port = 5432
pg_user = kong
pg_password = kong
pg_database = kong
pg_ssl = off
pg_ssl_verify = off

# Admin API settings
admin_listen = 0.0.0.0:8001
admin_gui_listen = 0.0.0.0:8002
admin_gui_url = http://localhost:8002

# Proxy settings
proxy_listen = 0.0.0.0:8000
proxy_listen_ssl = 0.0.0.0:8443

# SSL settings
ssl_cert = /usr/local/kong/ssl/tls.crt
ssl_cert_key = /usr/local/kong/ssl/tls.key

# Logging
log_level = info
proxy_access_log = /usr/local/kong/logs/access.log
proxy_error_log = /usr/local/kong/logs/error.log
admin_access_log = /usr/local/kong/logs/admin_access.log
admin_error_log = /usr/local/kong/logs/admin_error.log

# Performance settings
nginx_worker_processes = auto
nginx_worker_connections = 1024
upstream_keepalive = 60
upstream_keepalive_requests = 100
upstream_keepalive_timeout = 60

# Plugin settings
plugins = bundled
pluginserver_names = off

# Declarative configuration
declarative_config = /usr/local/kong/kong.yml

# Memory settings
lua_shared_dict = prometheus_metrics 5m
lua_shared_dict = rate_limiting_metrics 10m
lua_shared_dict = clustering_data_plane 5m

# Security settings
trusted_ips = 0.0.0.0/0,::/0
real_ip_header = X-Forwarded-For
real_ip_recursive = on

# Headers
server_tokens = off
headers = off
headers_upstream = X-Forwarded-Host

# DNS settings
dns_resolver = 8.8.8.8,8.8.4.4
dns_hostsfile = /etc/hosts
dns_order = LAST,SRV,A,CNAME
